安全にデプロイするための手順

概要

このプロジェクトは画像を扱います。デプロイ前に必ず以下の手順を行い、著作権・肖像権・リポジトリ履歴の安全性を確保してください。

1) アップロードを無効化（デフォルト）
- デフォルトではアップロード機能は無効化されています。
- 本番でアップロードを有効にするには環境変数を設定してください（強く推奨しません）。
  - ENABLE_ADMIN_UPLOADS=true
  - ADMIN_TOKEN=<強いランダムなトークン>

2) 既存の画像の監査
- `public/assets` に含まれる画像をすべて確認し、各画像の出典とライセンスを記録してください。
- 出典が不明、またはライセンスが再配布を許さない場合は削除してください。

3) リポジトリ履歴のクリーニング（必要な場合）
- 既にコミット履歴に大きな画像が含まれている場合、BFG や git-filter-repo を使って履歴から除去してください。
- 手順は `scripts/remove_binaries.ps1` を参照してください。作業前にバックアップを必ず取ってください。

4) 画像の運用方針
- 可能なら画像は git ではなく外部ストレージ（S3 など）に保管し、署名付きアップロード（presigned URL）を使いましょう。
- サイトに画像の出典（source / license）と苦情連絡先（DMCA 相当）を明示してください。

5) デプロイ（コンテナ推奨）
- このリポジトリには `Dockerfile` を追加しています。コンテナ化してデプロイするのが簡単で安全です。
- GitHub Actions のテンプレートを `.github/workflows/ci.yml` に追加しました。GHCR へプッシュする場合は `CR_PAT`（パッケージ: write:packages 権限）を Secrets に追加してください。

6) 連絡先と削除フロー
- サイト上に運営者連絡先（メール）と、画像削除リクエストへの対応ポリシーを掲載してください。

追加サポート
- リポジトリ履歴の除去（BFG/git-filter-repo）の実行支援、外部ストレージ移行、CI の秘密情報設定などをサポートします。実行して良い作業を教えてください。
